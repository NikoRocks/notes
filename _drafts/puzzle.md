---
layout: index
title: Puzzle
categories: [math, coursera]
---

В курсе [Algorythms: Design and Analysis][algo course] на Coursera (на который,
к слову, забил, предпочев книжке Кормена) посоветовали
[Mathematics for Computer Science][book] за авторством двух товарищей из
Принстонского университета, дабы восполнить пробелы в необходимом математическом
бэкграунде.

Начал читать, весьма понравилась, в главе про доказательство с использованием
индукции так понравился пример использования оной, что решил перевести и
поделиться. По моему, весьма хороший пример процесса доказательства вообще и
доказательства с использованием математической индукции в частности.

Итак, есть мозайка. Она состоит из пятнадцати пронумерованных ячеек и одной
пустой, находящихся в сетке 4 на 4. Любая пронумерованная ячейка, соседствующая
с пустой, может быть перемещена в сторону постой. К примеру, ниже изображены два
последовательных движения:

     1   2   3   4       1   2   3   4       1   2   3   4
     5   6   7   8  →    5   6   7   8  →    5   6   7   8
     9  10  11  12       9  10  11  12       9  10      12
    13  15  14          13  15      14      13  15  11  14

В самом левом состоянии мазайки выше ячейки 14 и 15 идут не по порядку. Сможете
ли вы найти такую последовательность перемещений, которые расставят все ячейки в
нужном порядке? После нескольких экспериметов ответом, вероятно, будет "нет". Но
давайте попробуем это доказать.

Мы будем использовать подход, который часто используется при аналезе программных
продуктов и систем. Мы будем смотреть на инвариант, свойство мазайки, которое
всегда остается истинным, вне зависимости от того, как вы двигаете ячейки. Если
мы сможем показать, что перемена ячеек 14 и 15 местами нарушит инвариант, значит
мы можем подытожить, что это невозможно.

Итак, приступим. Вот теорема, которую мы пытаемся доказать:

**Теорема 1.** *Нет такой последовательности перемещений ячеек, которые изменят
мозайку из состояния, изображенного внизу слева в состояние, изображенное внизу
справа.*

     1   2   3   4      1   2   3   4
     5   6   7   8      5   6   7   8
     9  10  11  12      9  10  11  12
    13  15  14         13  14  15

Мы будем выстраивать последовательность наблюдений в виде лемм. Как только будет
достигнута критическая масса, мы объединим эти наблюдения в непосредственно
доказательство.

Определим движение строки как движение, при котором ячейки перемещаются
горизонтально, и движение столбца как движение, при котором ячейки перемещаются
вертикально. Условимся, что ячейки читаются слева направа сверху вних как
обычный английский текст; то есть, когда мы говорим, что ячейки расставлены "не
по порядку", мы подразумеваем, что больший номер ячейки находится перед меньшим
в заданном порядке.

Сложность в нашем случае в том, что одна пара ячеек (14 и 15) находится в
неверном порядке изначально. Из этого сразу же можно сделать наблюдение, что
простое движение строки не сильно помогает нам в нашем доказательстве, а именно:

**Лемма 2.** *Движение строки не меняет порядок ячеек*

Обычно лемма требует доказательства. Тем не менее, в данном случае нет ничего
более убедительного, чем непосредственно наблюдение, поэтому мы оставим это
высказывание и двинемся дальше, к движениям столбцов.

**Лемма 3.** *Движение столбца меняет относительный порядок ровно трех пар
ячеек*

К примеру, движение стобца, изображенное ниже, меняет относительный порядок пар
ячеек (j, g), (j, h) и (j, i).

    a  b  c  d      a  b  c  d
    e  f     g  →   e  f  j  g
    h  i  j  k      h  i     k
    l  m  n  o      l  m  n  o

*Доказательство.* Движение ячейки вних смещает ее относительно следующих трех
ячеек, идущих следом. Движение ячейки вверх смещает ее относительно трех ячеек,
идущих перед ней. □

Эти наблюдения показывают, что существуют ограничение на то, как ячейки могут
меняться местами. Некоторые такие ограничения могут привести нас к нужному нам
инварианту. Чтобы рассуждать об обмене ячеек местами более точно, давайте
сделаем определение: пара ячеек i и j инвертирована, если i < j, но при этом i
находится после j в нашей мозайке. К примеру, в мозайке ниже есть четыре
инвертированных ячейки: (12, 11), (13, 11), (15, 11) и (15, 14).

     1   2   3   4
     5   6   7   8
     9  10      12
    13  15  11  14

Давайте рассмотрим эффекты движений строк и столбцов в терминах инверсии ячеек.

**Лемма 4.** *Движение строки никогда не меняет четность числа инверсий.
Движение столбца всегда меняет четность числа инверсий.*

"Четность" числа говорит о том, является оно четным либо нечетным. К примеру,
числа 7 и -5 - нечетные, а 18 и 0 - четные.

*Доказательство.* Согласно лемме 2, движение строки не меняет порядок ячеек;
таким образом, в частности, движение строки не меняет числа инверсий.

Согласно лемме 3, движение столбца меняет относительный порядок ровно трех пар
ячеек. Таким образом, инвертированная пара становится неинвертированной и
наоборот. Таким образом, один обмен меняет четность общего числа инверсий на
противоположную, второй меняет ее в исходное значение, а третий - вновь на
противоположную. □



[algo course]: https://www.coursera.org/course/algo
[book]: http://www.cs.princeton.edu/courses/archive/spr10/cos433/mathcs.pdf
